# 格式
本项目中每个接口使用如下格式记录：
```md
## 接口名称
*权限*
**URL**
接口说明
### 请求头部字段
### 请求体数据
### 返回
### 返回情况一
状态码：**XXX**
说明
#### 返回头部字段
#### 返回数据格式
### 返回情况二
```

以下为一个例子：
## 添加文章
*需要登陆*
**POST /api/articles**
### 请求体数据
```
JSON {
required:
    content: String,
    title: String
optional:
    editState: 'published' | 'draft' (默认为'published')
}
```
## 返回
### 当文章成功新建：
状态码：**201 Created**

### 当文章标题或内容为空时
状态码：**400 Bad Request**
### 返回数据格式
```
{
    reason: {
        'empty title': true（当标题为空）,
        'empty content': true（当内容为空）
    }
}
```

# 错误处理
当请求有错误而被服务器拒绝处理时，服务器将返回一个错误回复，这个错误回复的数据格式为：
```
JSON {
required:
    reason: ErrorCodeString, 
}
```
其中，reason为描述错误发生原因的字符串，下文中我们将之乘称作“错误码”。这个数据格式可以根据具体情况补充更多的字段。

一个请求中可以有多个错误，比如它没有携带登陆信息，而且缺乏必填字段。服务器接到请求后，会对该请求做一系列检查，一旦某个检查没有通过，就会停止执行接下来的检查，并立即返回带有相应的错误码的错误回复。这么做主要是为了简化流程，并提高服务器处理请求的效率。

## “需要登陆”
原因：接口需要登陆凭证才可被使用，但请求中缺乏该登陆凭证。
状态码：**401**
错误码：unauthorized

## 缺乏必须字段
原因：请求中缺乏接口的必填字段
状态码：**400**
错误码：missed required fields
额外的错误字段：
`fields: [String]` → 所有请求中缺乏的必填的请求字段的名字

## 字段不符合要求
原因：请求数据的某些字段的数据不符合接口的数据要求。
状态码：**400**
错误码：illegal fields
额外的错误字段：
`fields: [String]`→ 所有不符合要求的数据字段

# API
## 和文章有关的API

需求：

1. 从本地上传图片
2. 从相册中新增图片
3. 删除文章中的图片

### 文章实体定义

```
{
	id: String,
	title: String,
	createdTime: Timestamp,
	firstPublishTime: null | Timestamp,
	lastEditTime: Timestamp
	content: String,
	columnID: String,
	seriesID: String,
	state: 'published' | 'draft',
	imageRefs: [URL],
	localImages: []
}
```

### 新增单个文章

*需要登陆*
URL：**POST /articles**

#### 请求数据格式

```
{
required:
    content: String（非空）,
    title: String（非空）,
    column: String（非空）,
optional:
    series: String （默认无）
    editState: 'published' | 'draft' (默认为'published')，
    imageRefs: [URLString]
}
```

#### 返回

1. 当文章被成功新建：
    状态码：**201 Created**
2. 当文章标题为空时
    状态码：**400 Bad Request**
    错误码：empty title
3. 当文章内容为空时
    状态码：**400 Bad Request**
    错误码：empty content
4. 当无指定专栏时
    状态码：**400 Bad Request**
    错误码：no such column
5. 当无指定系列时
    状态码：**400 Bad Request**
    错误码：no such series

### 按照ID删除单个文章

*需要登陆*
URL：**DELETE /api/articles/{{articleId}}**

#### 请求数据格式

```
JSON {
required:
    articleId: {{articleId}}
}
```

#### 返回
1. 当文章被成功删除：
    状态码：**204 No Content**
2. 当文章不存在时：
    状态码：**404 Not Found**

### 按照ID批量删除文章（更新文章列表）

*需要登陆*
URL：**PATCH /api/articles**

#### 数据格式

```
{
required: 
    operation: 'bulk delete',
    articleId: [String]
}
```

#### 返回

1. 当文章被成功删除时
    状态码：**200 OK**
    返回被删除的文章个数：
    
    ```
    { count: Number }
    ```
2. 当`operation`不是`'bulk delete'`时
    状态码：**400**
    错误码：'unknown operation'

### 修改单个文章

*需要登陆*

URL：**PUT /article/**

### 数据格式

```
{
    
}
```



### 获取单个文章信息
### 筛选文章并分页
要求：按照专栏和系列来筛选文章，并将筛选结果按照发布时间排列
### 修改“关于本站”的信息

## 和专栏相关的API
### 新建单个专栏
### 删除单个专栏
删除本专栏和其中所有系列和文章
### 修改单个专栏
### 获得某个专栏的信息
### 获得所有专栏的信息

## 和系列相关的API
### 新增单个系列
### 删除系列
删除本系列和其中所有文章
### 修改单个系列
### 获得单个系列的信息
### 获得某个专栏下的所有系列的信息

## 和用户相关的API
### 修改用户信息

## 和图片相关的API
### 新增本地图片
### 删除本地图片
### 修改本地图片信息
1. 修改图片名
2. 修改图片的分类
### 查看图片信息
1. 查看图片名
2. 查看图片的分类
### 查看图片内容
二进制内容
